<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AI-EA 週次進捗 - 2026-02-06</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body { font-family: 'Segoe UI', 'Hiragino Sans', 'Noto Sans JP', sans-serif; background: #0f172a; color: #e2e8f0; }
  .slide {
    width: 100vw; min-height: 100vh; padding: 50px 70px;
    display: flex; flex-direction: column; justify-content: center;
    border-bottom: 2px solid #1e293b;
    page-break-after: always;
  }
  h1 { font-size: 2.8em; color: #38bdf8; margin-bottom: 15px; }
  h2 { font-size: 2em; color: #38bdf8; margin-bottom: 20px; }
  h3 { font-size: 1.3em; color: #7dd3fc; margin-bottom: 10px; margin-top: 18px; }
  p, li { font-size: 1.1em; line-height: 1.6; color: #cbd5e1; }
  ul { padding-left: 25px; }
  li { margin-bottom: 5px; }
  .subtitle { font-size: 1.2em; color: #94a3b8; margin-bottom: 25px; }
  .highlight { color: #4ade80; font-weight: bold; }
  .negative { color: #f87171; font-weight: bold; }
  .neutral { color: #fbbf24; font-weight: bold; }
  .badge { display: inline-block; padding: 3px 12px; border-radius: 20px; font-size: 0.8em; font-weight: bold; margin-left: 8px; }
  .badge-ml { background: #7c3aed33; color: #a78bfa; border: 1px solid #7c3aed; }
  .badge-rule { background: #0891b233; color: #22d3ee; border: 1px solid #0891b2; }
  .badge-llm { background: #b4530033; color: #fb923c; border: 1px solid #b45300; }
  table { width: 100%; border-collapse: collapse; margin: 15px 0; font-size: 1em; }
  th { background: #1e293b; color: #38bdf8; padding: 10px 14px; text-align: left; border-bottom: 2px solid #334155; }
  td { padding: 8px 14px; border-bottom: 1px solid #1e293b; color: #cbd5e1; }
  .right { text-align: right; }
  .card { background: #1e293b; border-radius: 10px; padding: 18px; margin: 8px 0; border-left: 4px solid #38bdf8; }
  .card-green { border-left-color: #4ade80; }
  .card-red { border-left-color: #f87171; }
  .card-yellow { border-left-color: #fbbf24; }
  .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
  .grid-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 16px; }
  .grid-4 { display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 16px; }
  .stat-box { background: #1e293b; border-radius: 10px; padding: 18px; text-align: center; }
  .stat-value { font-size: 2.2em; font-weight: bold; color: #38bdf8; }
  .stat-label { font-size: 0.85em; color: #94a3b8; margin-top: 4px; }
  .stat-value.green { color: #4ade80; }
  .small { font-size: 0.85em; color: #64748b; }
  .code { background: #0f172a; border: 1px solid #334155; border-radius: 8px; padding: 14px; font-family: monospace; font-size: 0.9em; color: #a5f3fc; margin: 8px 0; }
  .fn { display: inline-flex; align-items: center; justify-content: center; width: 30px; height: 30px; border-radius: 50%; background: #38bdf8; color: #0f172a; font-weight: bold; font-size: 1em; margin-right: 8px; }
  @media print { .slide { page-break-after: always; } }
</style>
</head>
<body>

<!-- ==================== SLIDE 1: タイトル ==================== -->
<div class="slide" style="text-align: center;">
  <h1 style="font-size: 3em;">AI-EA Advanced</h1>
  <p class="subtitle" style="font-size: 1.6em;">週次進捗レポート</p>
  <p style="font-size: 1.3em; color: #64748b;">2026年2月3日（月）〜 2月6日（木）</p>
  <div style="margin-top: 30px;">
    <div class="grid-4" style="max-width: 900px; margin: 0 auto;">
      <div class="stat-box">
        <div class="stat-value green">8</div>
        <div class="stat-label">新機能を実装</div>
      </div>
      <div class="stat-box">
        <div class="stat-value">227+</div>
        <div class="stat-label">テスト全件合格</div>
      </div>
      <div class="stat-box">
        <div class="stat-value green">+11%</div>
        <div class="stat-label">勝率改善</div>
      </div>
      <div class="stat-box">
        <div class="stat-value green">-29%</div>
        <div class="stat-label">DD削減</div>
      </div>
    </div>
  </div>
</div>

<!-- ==================== SLIDE 2: 今週の全体像 ==================== -->
<div class="slide">
  <h2>今週の実装一覧</h2>

  <div class="grid">
    <div>
      <h3>2/3（月）〜 2/4（火）：最適化基盤</h3>
      <div class="card" style="margin-bottom: 8px;">
        <p><span class="fn">1</span><strong>Optunaパラメータ最適化</strong> <span class="badge badge-ml">Optuna</span></p>
        <p class="small">ベイズ最適化でSL/TP/ADX等を自動チューニング</p>
      </div>
      <div class="card" style="margin-bottom: 8px;">
        <p><span class="fn">2</span><strong>ウォークフォワード検証（WFO）</strong> <span class="badge badge-ml">ML</span></p>
        <p class="small">時系列を5分割し、過学習していないか検証</p>
      </div>
      <div class="card" style="margin-bottom: 8px;">
        <p><span class="fn">3</span><strong>最適化ループ＋スケジューラー</strong> <span class="badge badge-rule">自動化</span></p>
        <p class="small">毎日自動で全通貨ペアを再最適化するパイプライン</p>
      </div>
    </div>
    <div>
      <h3>2/5（水）〜 2/6（木）：AI機能</h3>
      <div class="card" style="margin-bottom: 8px;">
        <p><span class="fn">4</span><strong>マルチタイムフレーム確認</strong> <span class="badge badge-rule">ルール</span></p>
        <p class="small">H1シグナルをH4トレンドで確認、偽シグナル除外</p>
      </div>
      <div class="card" style="margin-bottom: 8px;">
        <p><span class="fn">5</span><strong>アダプティブ決済</strong> <span class="badge badge-rule">ATR</span></p>
        <p class="small">トレーリングストップで利益を動的にロック</p>
      </div>
      <div class="card" style="margin-bottom: 8px;">
        <p><span class="fn">6</span><strong>マーケットレジーム検知</strong> <span class="badge badge-ml">KMeans</span></p>
        <p class="small">市場状態を自動分類、パラメータ調整</p>
      </div>
      <div class="card" style="margin-bottom: 8px;">
        <p><span class="fn">7</span><strong>ニュースフィルター</strong> <span class="badge badge-rule">ルール</span></p>
        <p class="small">NFP/FOMC/BOJ前後で取引自動停止</p>
      </div>
      <div class="card" style="margin-bottom: 8px;">
        <p><span class="fn">8</span><strong>AI最適化レポート</strong> <span class="badge badge-llm">GPT-4o</span></p>
        <p class="small">最適化結果を日本語で分析レポート生成</p>
      </div>
    </div>
  </div>
</div>

<!-- ==================== SLIDE 3: Optuna + WFO ==================== -->
<div class="slide">
  <h2><span class="fn">1</span><span class="fn">2</span> Optuna最適化 ＋ ウォークフォワード検証</h2>
  <p class="subtitle">パラメータを自動チューニングし、過学習を防止</p>

  <div class="grid">
    <div>
      <h3>Optuna最適化とは</h3>
      <p>トレーディングのパラメータ（SL倍率、TP倍率、ADX閾値など）を<strong>ベイズ最適化</strong>で自動探索。人間が手動で試すより遥かに効率的。</p>
      <div class="card" style="margin-top: 10px;">
        <p><strong>最適化対象パラメータ：</strong></p>
        <p class="small">adx_threshold, slope_threshold, buy_position, sell_position, tp_mult, sl_mult, rsi_buy_max, rsi_sell_min</p>
      </div>

      <h3>ウォークフォワード検証とは</h3>
      <p>「バックテスト結果が良い＝本番でも勝てる」ではない。WFOは過去データを5分割し、各区間で最適化→未知データでテストを繰り返す。</p>
      <div class="card card-green">
        <p><strong>ロバストネス比率</strong> = out-sample PF ÷ in-sample PF</p>
        <p class="small">0.5以上で合格 → 過学習していないと判断</p>
      </div>
    </div>
    <div>
      <h3>なぜ重要か（図解）</h3>
      <div class="card card-red">
        <p><strong>WFOなし（危険）</strong></p>
        <p class="small">全データで最適化 → バックテスト勝率90%！ → 本番で大損</p>
        <p class="small">＝カンニングしてテストに受かったのと同じ</p>
      </div>
      <div class="card card-green">
        <p><strong>WFOあり（安全）</strong></p>
        <p class="small">区間1で最適化 → 区間2で検証 → 区間2で最適化 → 区間3で検証...</p>
        <p class="small">＝未知の問題でも解けるか確認</p>
      </div>

      <h3>実行結果</h3>
      <table>
        <tr><th>通貨</th><th class="right">ロバストネス</th><th class="right">判定</th></tr>
        <tr><td>USDJPY</td><td class="right">0.68</td><td class="right" style="color:#4ade80;">合格</td></tr>
        <tr><td>XAUJPY</td><td class="right">0.55</td><td class="right" style="color:#4ade80;">合格</td></tr>
        <tr><td>BTCJPY</td><td class="right">0.72</td><td class="right" style="color:#4ade80;">合格</td></tr>
      </table>
    </div>
  </div>
</div>

<!-- ==================== SLIDE 4: 最適化ループ + スケジューラー ==================== -->
<div class="slide">
  <h2><span class="fn">3</span> 最適化ループ ＋ 自動スケジューラー</h2>
  <p class="subtitle">毎日自動で全通貨ペアを再最適化するパイプライン</p>

  <div class="grid">
    <div>
      <h3>自動化の流れ</h3>
      <div class="card">
        <p><strong>① 毎日AM3:00（市場閑散期）</strong></p>
        <p class="small">スケジューラーが自動起動</p>
      </div>
      <div class="card">
        <p><strong>② 各通貨ペアでOptuna最適化実行</strong></p>
        <p class="small">最新データで最適パラメータを探索</p>
      </div>
      <div class="card">
        <p><strong>③ 安全チェック</strong></p>
        <p class="small">改善率、ドローダウン、WFO検証をチェック</p>
      </div>
      <div class="card card-green">
        <p><strong>④ 合格時のみ自動適用</strong></p>
        <p class="small">パラメータをJSONに保存、履歴も記録</p>
      </div>
    </div>
    <div>
      <h3>安全ガード</h3>
      <ul>
        <li>改善率が閾値未満 → 不採用</li>
        <li>ドローダウンが基準超過 → 不採用</li>
        <li>WFO不合格 → 不採用</li>
        <li>全変更は履歴に記録（ロールバック可能）</li>
      </ul>

      <h3>API + ダッシュボード</h3>
      <div class="card">
        <p>FastAPI エンドポイント提供：</p>
        <p class="small">POST /optimize/{symbol} — 手動最適化</p>
        <p class="small">GET /status — 各通貨の最新状態</p>
        <p class="small">HTMLダッシュボードで結果をブラウザ確認</p>
      </div>
    </div>
  </div>
</div>

<!-- ==================== SLIDE 5: MTF + アダプティブ決済 ==================== -->
<div class="slide">
  <h2><span class="fn">4</span><span class="fn">5</span> MTFフィルター ＋ アダプティブ決済</h2>

  <div class="grid">
    <div>
      <h3>MTF：偽シグナルを除外</h3>
      <p>1時間足でBUYシグナルが出ても、4時間足が下降トレンドなら<strong>取引しない</strong>。</p>
      <div class="card card-green">
        <p><strong>効果：</strong>USDJPYでドローダウン <span class="highlight">-19.5%</span> 削減</p>
        <p class="small">トレード数 1,612 → 1,255（質の低いトレードを除外）</p>
      </div>
      <div class="card card-yellow">
        <p><strong>注意：</strong>XAUJPYではデータ不足（781本）で効果限定的</p>
      </div>
    </div>
    <div>
      <h3>アダプティブ決済：利益をロック</h3>
      <p>旧コード：TP/SL固定 → 利益が80%まで伸びても戻ってSL負け</p>
      <p>新コード：一定以上利益が出たら<strong>トレーリングストップ発動</strong>、利益を確保</p>
      <div class="stat-box" style="margin-top: 10px;">
        <div class="stat-value green">+11.4%</div>
        <div class="stat-label">平均勝率改善（全通貨ペア）</div>
      </div>
      <table>
        <tr><th>通貨</th><th class="right">旧</th><th class="right">新</th></tr>
        <tr><td>USDJPY</td><td class="right">45.2%</td><td class="right highlight">56.3%</td></tr>
        <tr><td>XAUJPY</td><td class="right">46.7%</td><td class="right highlight">58.7%</td></tr>
        <tr><td>BTCJPY</td><td class="right">46.9%</td><td class="right highlight">58.5%</td></tr>
      </table>
    </div>
  </div>
</div>

<!-- ==================== SLIDE 6: レジーム検知 + ニュース ==================== -->
<div class="slide">
  <h2><span class="fn">6</span><span class="fn">7</span> レジーム検知 ＋ ニュースフィルター</h2>

  <div class="grid">
    <div>
      <h3>レジーム検知（KMeans ML）</h3>
      <p>市場を3種類に自動分類し、それぞれに最適なパラメータを適用：</p>
      <table>
        <tr><th>レジーム</th><th>調整</th></tr>
        <tr><td style="color:#4ade80;">トレンド</td><td>TP拡大 → 大きく稼ぐ</td></tr>
        <tr><td style="color:#fbbf24;">レンジ</td><td>TP縮小、ADX厳格化 → 慎重に</td></tr>
        <tr><td style="color:#f87171;">ボラティル</td><td>SL縮小 → 損失制限</td></tr>
      </table>
      <div class="card card-green">
        <p><strong>BTCJPY（トレンド検知）：</strong></p>
        <p>利益 ¥460万→<span class="highlight">¥665万（+44%）</span>、DD <span class="highlight">-32.8%</span></p>
      </div>
    </div>
    <div>
      <h3>ニュースフィルター</h3>
      <p>NFP/FOMC/BOJ等の重要経済イベント前後で<strong>自動取引停止</strong>。</p>
      <table>
        <tr><th>イベント</th><th>停止期間</th></tr>
        <tr><td>NFP（米雇用統計）</td><td>-4h 〜 +2h</td></tr>
        <tr><td>FOMC（金利決定）</td><td>-4h 〜 +2h</td></tr>
        <tr><td>BOJ（日銀会合）</td><td>-4h 〜 +2h</td></tr>
        <tr><td>CPI / GDP / ECB</td><td>-2h 〜 +1h</td></tr>
      </table>
      <div class="card">
        <p><strong>設計判断：</strong>AI/LLMではなくルールベース</p>
        <p class="small">理由：決定論的、無料、ハルシネーションなし、オフライン動作</p>
      </div>
    </div>
  </div>
</div>

<!-- ==================== SLIDE 7: AIレポート ==================== -->
<div class="slide">
  <h2><span class="fn">8</span> AI最適化レポート</h2>
  <p class="subtitle">最適化結果をGPT-4o-miniで日本語レポート自動生成</p>

  <div class="grid">
    <div>
      <h3>仕組み</h3>
      <div class="card">
        <p><strong>パス1：</strong>LLMが新旧パラメータを分析→JSON出力</p>
      </div>
      <div class="card">
        <p><strong>パス2：</strong>JSONを読みやすい日本語レポートに変換</p>
      </div>
      <div class="card card-green">
        <p><strong>フォールバック：</strong>APIダウン時もテンプレートで自動生成</p>
      </div>
    </div>
    <div>
      <h3>法的コンプライアンス</h3>
      <div class="card card-red">
        <p><strong>免責事項（DISCLAIMER_JP）</strong></p>
        <p class="small">ハードコード定数 — 全レポートに必ず付与。LLMでは削除不可。</p>
        <p class="small" style="color:#f87171;">「過去のデータに基づくバックテスト結果であり、将来の利益を保証するものではありません」</p>
      </div>
      <p class="small" style="margin-top:10px;">日本での売り切り型EA販売に必要な法的要件を遵守</p>
    </div>
  </div>
</div>

<!-- ==================== SLIDE 8: パフォーマンス比較 ==================== -->
<div class="slide">
  <h2>パフォーマンス比較：旧 vs 新</h2>
  <p class="subtitle">実データ（H1ローソク足）でのバックテスト結果</p>

  <h3>USDJPY — 12,437本</h3>
  <table>
    <tr><th>モード</th><th class="right">トレード</th><th class="right">勝率</th><th class="right">PF</th><th class="right">最大DD</th></tr>
    <tr><td>旧コード</td><td class="right">1,612</td><td class="right">45.2%</td><td class="right">1.05</td><td class="right">6.9</td></tr>
    <tr style="background:#1e293b;"><td><strong>全機能ON</strong></td><td class="right"><strong>1,296</strong></td><td class="right highlight"><strong>57.1%</strong></td><td class="right highlight"><strong>1.08</strong></td><td class="right highlight"><strong>4.9（-29%）</strong></td></tr>
  </table>

  <h3>BTCJPY — 8,853本</h3>
  <table>
    <tr><th>モード</th><th class="right">トレード</th><th class="right">勝率</th><th class="right">PF</th><th class="right">利益（¥）</th><th class="right">最大DD（¥）</th></tr>
    <tr><td>旧コード</td><td class="right">1,189</td><td class="right">46.9%</td><td class="right">1.10</td><td class="right">4,615,616</td><td class="right">1,689,981</td></tr>
    <tr style="background:#1e293b;"><td><strong>全機能ON</strong></td><td class="right"><strong>1,238</strong></td><td class="right highlight"><strong>58.5%</strong></td><td class="right highlight"><strong>1.19</strong></td><td class="right highlight"><strong>6,657,317（+44%）</strong></td><td class="right highlight"><strong>1,136,398（-33%）</strong></td></tr>
  </table>

  <h3>XAUJPY — 781本</h3>
  <table>
    <tr><th>モード</th><th class="right">トレード</th><th class="right">勝率</th><th class="right">PF</th><th class="right">利益（¥）</th></tr>
    <tr><td>旧コード</td><td class="right">107</td><td class="right">46.7%</td><td class="right">1.23</td><td class="right">23,869</td></tr>
    <tr style="background:#1e293b;"><td><strong>全機能ON</strong></td><td class="right"><strong>85</strong></td><td class="right highlight"><strong>56.5%</strong></td><td class="right">1.22</td><td class="right">13,450</td></tr>
  </table>
</div>

<!-- ==================== SLIDE 9: 課題と限界 ==================== -->
<div class="slide">
  <h2>正直な評価：課題と限界</h2>

  <div class="grid">
    <div>
      <div class="card card-red" style="margin-bottom: 10px;">
        <h3 style="color:#f87171;">XAUJPYでデータ不足</h3>
        <p class="small">781本のH1ではMTF・レジーム検知の精度が低い。MTF単体で利益が¥23,869→¥7,401に減少。3,000本以上のデータが必要。</p>
      </div>
      <div class="card card-yellow" style="margin-bottom: 10px;">
        <h3 style="color:#fbbf24;">アダプティブ決済のデフォルト値</h3>
        <p class="small">トレーリングのパラメータは全通貨共通のデフォルト値。通貨ペアごとにOptunaで個別最適化が必要。</p>
      </div>
      <div class="card card-yellow" style="margin-bottom: 10px;">
        <h3 style="color:#fbbf24;">PF改善は控えめ（+0.03〜0.09）</h3>
        <p class="small">勝率は大幅改善だが、トレーリングがTP手前で決済するため平均利益がやや減少。</p>
      </div>
    </div>
    <div>
      <div class="card card-yellow" style="margin-bottom: 10px;">
        <h3 style="color:#fbbf24;">レジーム検知の精度</h3>
        <p class="small">USDJPY・XAUJPYが両方「レンジ」に分類。データの多様性不足でKMeansの分離が不十分な場合あり。</p>
      </div>
      <div class="card card-yellow" style="margin-bottom: 10px;">
        <h3 style="color:#fbbf24;">ニュースカレンダーは静的</h3>
        <p class="small">2026年分がハードコード。年次更新が必要。突発イベント（緊急利上げ等）には非対応。</p>
      </div>
      <div class="card card-yellow" style="margin-bottom: 10px;">
        <h3 style="color:#fbbf24;">まだペーパートレード未実施</h3>
        <p class="small">バックテストのみ。本番投入前に最低3ヶ月のペーパートレードが必須。</p>
      </div>
    </div>
  </div>
</div>

<!-- ==================== SLIDE 10: テスト + まとめ ==================== -->
<div class="slide">
  <h2>テスト品質 ＋ まとめ</h2>

  <div class="grid-3" style="margin-bottom: 25px;">
    <div class="stat-box">
      <div class="stat-value">227+</div>
      <div class="stat-label">テスト総数</div>
    </div>
    <div class="stat-box">
      <div class="stat-value green">100%</div>
      <div class="stat-label">合格率</div>
    </div>
    <div class="stat-box">
      <div class="stat-value">0</div>
      <div class="stat-label">既存テスト破壊</div>
    </div>
  </div>

  <div class="grid">
    <div>
      <h3>今週追加したテスト</h3>
      <table>
        <tr><th>対象</th><th class="right">件数</th></tr>
        <tr><td>Optuna最適化</td><td class="right">複数</td></tr>
        <tr><td>ウォークフォワード</td><td class="right">複数</td></tr>
        <tr><td>最適化ループ</td><td class="right">複数</td></tr>
        <tr><td>アダプティブ決済</td><td class="right">18</td></tr>
        <tr><td>ニュースフィルター</td><td class="right">25</td></tr>
        <tr><td>レジーム検知</td><td class="right">24</td></tr>
        <tr><td>AIレポート</td><td class="right">16</td></tr>
      </table>
    </div>
    <div>
      <h3>今後の計画</h3>
      <div class="card" style="margin-bottom: 8px;">
        <p><strong>直近：</strong>WFOを最適化ループの安全ゲートとして統合</p>
      </div>
      <div class="card" style="margin-bottom: 8px;">
        <p><strong>直近：</strong>通貨ペアごとにトレーリングパラメータを個別最適化</p>
      </div>
      <div class="card" style="margin-bottom: 8px;">
        <p><strong>中期：</strong>3ヶ月のペーパートレード実施</p>
      </div>
      <div class="card" style="margin-bottom: 8px;">
        <p><strong>中期：</strong>ニュースカレンダーをAPI化</p>
      </div>
    </div>
  </div>

  <div class="card card-green" style="margin-top: 15px; text-align: center;">
    <p style="font-size: 1.2em;"><strong>まとめ：</strong>最適化基盤（Optuna＋WFO＋自動スケジューラー）＋ AI機能5件を実装。勝率+11%、DD-29%改善。全テスト合格、後方互換性維持。</p>
  </div>
</div>

</body>
</html>
