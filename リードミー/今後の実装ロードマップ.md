AI EAプロジェクト：今後の実装ロードマップ (Phase 2 & 3)

現在の「Ver 2.1 (Advanced Logic)」で基本動作と通信の安定性は確立されました。
次は、実運用における「安全性」「ユーザー体験」「収益性」を高めるための機能拡張フェーズです。

特にPhase 2では、生成AI（LLM）の段階的統合と、それに伴う**「APIコスト管理・収益化モデル」の実装**を行います。
※phase1は現状のもの

Phase 2: 生成AIの段階的統合（Generative AI Integration）

【Ver 2.1】生成AIによる決済判断・相場観の統合 (Technical AI Agent)

まずは「外部ニュースなし」で、チャートデータのみを使って生成AIの判断能力をテストします。

コンセプト:

従来の「固定計算式（ATR×0.5）」だけでなく、生成AIに数値データを「言葉」として読ませ、トレーダーのような柔軟な判断（利確・損切り）を行わせる。

機能:

Pythonサーバーが計算した指標（Slope, ATR, RSI, 乖離率など）をプロンプトに変換。

生成AI（GPT-4o / Gemini）への指示例:

「現在、強い上昇トレンド（Slope=0.0005）ですが、RSIが75で過熱気味です。直近高値まであと10pipsです。この状況での最適な利確ラインと損切りラインを提示してください。」

AIの回答を解析し、EAのSL/TPに反映させる。

【重要】API利用料に基づく料金プラン分岐の実装 (Monetization & API Management)

生成AIの利用にはコスト（トークン課金）が発生するため、ユーザーの利用形態に応じたシステム改修を行います。

1. プランA：BYOK（Bring Your Own Key）モード

ユーザーが自分のAPIキーを用意して使う形式。

対象: コストを抑えたいユーザー、既にAPIキーを持っている層。

料金: 安価（またはIB報酬のみで無料提供）。

システム要件:

ユーザーごとの設定DBに「APIキー保存カラム」を追加。

リクエスト時にユーザー設定のAPIキーを読み込んでOpenAI/Geminiを叩く処理の実装。

キーが未設定または無効な場合は、AI機能を自動OFFにする、またはエラーを返す。

2. プランB：Pro（Managed Key）モード

運営側が用意したAPIキーを使用する形式。

対象: APIキーの取得方法がわからない初心者、面倒な設定を省きたい層。

料金: 月額課金（サブスクリプション） ※API利用料相当分を上乗せ。

システム要件:

サーバー側の環境変数に設定された「マスターキー」を使用して推論を行う。

ユーザーごとの「月間トークン使用量」を計測・制限する機能（使いすぎ防止）。

【Ver 2.2】ファンダメンタルズ分析の実装とハイブリッド化 (Hybrid Analysis)

Ver 2.1が安定した後、外部要因（ニュース）を取り込みます。

機能:

ニュースAPIから取得したテキスト情報を生成AIに分析させ、「センチメントスコア（-10〜+10）」を算出。

ユーザー設定（ON/OFF）の追加:

ユーザーがEA設定で「ファンダメンタルズ分析: ON/OFF」を切り替えられるようにする。

OFFの場合: Ver 2.1の挙動（テクニカルのみ）で動作。

ONの場合: テクニカル判断に加え、ニューススコアが悪ければエントリーを見送る等のフィルターが発動。

Phase 2.5: ユーザビリティの向上（UX）

1. 取引通知システム (Notification)

機能:

AIがエントリーまたは決済をした瞬間に、指定したDiscordチャンネルやLINEにメッセージを送信。

内容例: 🚀 [BUY] USDJPY | AI判断: "上昇トレンド継続だが過熱感あり。早めの利確を推奨"

メリット: ユーザーがチャートを見ていなくても安心でき、ツールの継続率向上に繋がる。

2. ダッシュボードの構築 (Visualization)

技術: Pythonの Streamlit などを利用。

表示内容:

現在のAIの相場判断コメント（生成AIの出力）

ニュース分析結果（Ver 2.2 ON時）

本日の損益グラフ

Phase 3: ロジックの高度化（Logic & AI）

1. マルチタイムフレーム分析 (MTF)

「木を見て森も見る」ロジックへ進化させます。

機能: EAから「現在の足（H1）」だけでなく「長期足（D1/H4）」のデータも送信させ、長期トレンドに逆らわないエントリーを行う。

2. 機械学習モデルへの置換 (True AI)

現在の「線形回帰（統計計算）」を、本格的な「予測モデル」に置き換えます。

技術: LightGBM や LSTM (Deep Learning)。

機能: 過去の膨大なパターンを学習し、「1時間後に価格が上がっている確率」を予測するモデルを作成。

優先順位と進め方

Ver 2.1開発: まずはOpenAI APIキーを用意し、main_advanced.py に「AIに数値を渡してSL/TPを決めさせる関数」を追加する。

課金基盤の整備: ユーザーごとに「自分のキーを使うか、運営のキーを使うか」を選別するデータベース処理を実装する。

検証: デモ口座で稼働させ、AIが決めた決済ポイントが適切かを確認する。